\doxysection{TCP\+\_\+server.\+hpp}
\hypertarget{TCP__server_8hpp_source}{}\label{TCP__server_8hpp_source}\index{logic/include/network/TCP\_server.hpp@{logic/include/network/TCP\_server.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}Misc\_functions.hpp"{}}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}Network.hpp"{}}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classTCP__server}{TCP\_server}}}
\DoxyCodeLine{00007\ \{}
\DoxyCodeLine{00008\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00009\ \ \ \ \ std::set<in\_addr\_t>\ \mbox{\hyperlink{classTCP__server_ae7d04721c1edc76ad1c16ea2af0adbc7}{allowed\_ips}};\ }
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00014\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTCP__server_ab021f353a070bab6b22fdf4a86603992}{accept\_all}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00015\ \ \ \ \ \textcolor{comment}{//*\ sends\ a\ message\ after\ establishing\ connection\ to\ client.}}
\DoxyCodeLine{00016\ \ \ \ \ \textcolor{keywordtype}{bool}\ do\_handshake\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00022\ \ \ \ \ \mbox{\hyperlink{classTCP__server_a115208dce129a1e8dfa33862655cfe1d}{TCP\_server}}(u\_short\ port);}
\DoxyCodeLine{00023\ \ \ \ \ \mbox{\hyperlink{classTCP__server}{\string~TCP\_server}}();}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTCP__server_a3055d51884d319647a493d732457173e}{poll\_events}}();}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTCP__server_ab5c0d710cc925dd7f0d20b41d1392ff6}{allow\_ip}}(in\_addr\_t\ addr);}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTCP__server_ae4d6c90a77add45d96987b4404d073ad}{disallow\_ip}}(in\_addr\_t\ addr);}
\DoxyCodeLine{00039\ \ \ \ \ }
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keyword}{const}\ std::set<in\_addr\_t>\ \mbox{\hyperlink{classTCP__server_af0a10702522fe18967df27bb5d7081bf}{get\_allowed\_ips}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classTCP__server_ae7d04721c1edc76ad1c16ea2af0adbc7}{allowed\_ips}};\}}
\DoxyCodeLine{00044\ \ \ \ \ }
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keyword}{const}\ u\_short\ \mbox{\hyperlink{classTCP__server_afe74f74a3a5de61a41e50cb969f15e38}{get\_port}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classTCP__server_ac58f70ec0b2ea2ea45f448fcc5ed51f8}{own\_port}};\}}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{keyword}{const}\ std::optional<Socket\_info>\ \mbox{\hyperlink{classTCP__server_a9688e4d543bb876399b119c62be4e166}{get\_connection\_event}}();}
\DoxyCodeLine{00054\ \ \ \ \ }
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{const}\ std::vector<Socket\_info>\ get\_peers()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classTCP__server_af7a9502e5874fb363754c00fbe31f428}{peer\_info}};\}}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTCP__server_ad20fdfdaab5bb5d566767fce6213105b}{send\_to}}(\textcolor{keywordtype}{int}\ \textcolor{keywordtype}{id},\ std::vector<char>\ message);}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTCP__server_a3695b078ec21f883a051ef990ebe1bcb}{send\_all}}(std::vector<char>\ message);}
\DoxyCodeLine{00073\ \ \ \ \ }
\DoxyCodeLine{00080\ \ \ \ \ \mbox{\hyperlink{structSocket__inbound__message}{Socket\_inbound\_message}}\ \mbox{\hyperlink{classTCP__server_a48c0ae654fff267578735cf5008406f4}{get\_message}}();}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTCP__server_a57176d55bc600923cb8bb5a6b360dd2b}{disconnect\_peer}}(\textcolor{keywordtype}{int}\ \textcolor{keywordtype}{id});}
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTCP__server_a7363def05b63083c8e87ac1636b2eeef}{disconnect\_peer\_addr}}(\mbox{\hyperlink{structSocket__info}{Socket\_info}}\ \mbox{\hyperlink{classTCP__server_af7a9502e5874fb363754c00fbe31f428}{peer\_info}});}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00098\ \ \ \ \ u\_short\ \mbox{\hyperlink{classTCP__server_ac58f70ec0b2ea2ea45f448fcc5ed51f8}{own\_port}};\ }
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \ \ \ \ std::vector<pollfd>\ \mbox{\hyperlink{classTCP__server_a029e9b115b5290795a885e9592e436e2}{polled}};\ }
\DoxyCodeLine{00101\ \ \ \ \ std::vector<Socket\_info>\ \mbox{\hyperlink{classTCP__server_af7a9502e5874fb363754c00fbe31f428}{peer\_info}};\ }
\DoxyCodeLine{00102\ \ \ \ \ std::queue<Socket\_inbound\_message>\ \mbox{\hyperlink{classTCP__server_ad910536017f1b268702bb292fd18574f}{inbox}};\ }
\DoxyCodeLine{00103\ \ \ \ \ std::queue<Socket\_info>\ \mbox{\hyperlink{classTCP__server_a135f0291e7936a204a509ac775b10799}{connection\_log}};\ }
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \ \ std::thread\ receiver\_thread;}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00110\ \ \ \ \ std::atomic<bool>\ \mbox{\hyperlink{classTCP__server_a02ae86f53ff55ae0f3d7c8d344c71e08}{is\_running}};\ }
\DoxyCodeLine{00111\ \ \ \ \ std::mutex\ inbox\_mutex,\ peer\_list\_mutex,\ socket\_mutex,\ allowed\_list\_mutex,\ connection\_log\_mutex;}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTCP__server_abbf37e5cfeee1876d92ee0da590e7728}{handle\_request}}();}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTCP__server_a949ccf491f855e9baf7fb75f00c46a02}{handle\_client}}(\textcolor{keywordtype}{int}\ \textcolor{keywordtype}{id});}
\DoxyCodeLine{00123\ \};}

\end{DoxyCode}
